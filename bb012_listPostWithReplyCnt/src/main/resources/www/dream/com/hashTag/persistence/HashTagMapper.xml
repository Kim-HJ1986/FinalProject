<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
		
<mapper namespace="www.dream.com.hashTag.persistence.HashTagMapper">
<!-- resultMap : DB Table 정의 내역과 객체 정의 내역에 있어 mismatch(부조화)가 있을 시 이를 연동, 짝 지어주는 정보를 정의함 -->
	<resultMap type="www.dream.com.hashTag.model.HashtagVO" id="rmHashTagVO" >
		<!-- property는 자바의 객체명, column은 DB의 컬럼명 // id는 보통 primary key -->
		<id property="id" column="id"></id>
		<result property="hashtag" column="hashtag"></result>
		<result property="description" column="description"></result>
	</resultMap>
	
	<!-- public Set<HashtagVO> findExisting(@Param("setHashTag") Set<String> setHashTag); -->
	<select id="findExisting" resultMap="rmHashTagVO">
		select *
		  from s_hashtag
		 where hashtag in
		<foreach collection="setHashTag" item="word" open="(" separator="," close=")">
			#{word}
		</foreach>
	</select>
	
	<!-- public String getIds(int cnt); -->
	<select id="getIds" resultType="string">
		select genMultiId(#{cnt}) from dual
	</select>
	
	<!-- public int createHashTag(@Param("setNewHashTag") Set<HashtagVO> newHashtag); -->
	<insert id="createHashTag">
		INSERT ALL
			<foreach collection="setNewHashTag" item="ht">
				into s_hashtag(id, hashtag) VALUES(#{ht.id}, #{ht.hashtag})
			</foreach>
	    SELECT * FROM dual
    </insert>
	
	<!--	public int insertMapBetweenPost(@Param("setExisting") Set<HashtagVO> setExisting,
											@Param("postId") String id)-->
	<insert id="insertMapBetweenPost">
		INSERT ALL
			<foreach collection="setExisting" item="hashtag">
				INTO sm_ht2post (hashtag_id, post_id, occur_cnt) VALUES (#{hashtag.id}, #{postId}, #{hashtag.occurCnt})
			</foreach>
	    SELECT * FROM dual
    </insert>
</mapper>




    